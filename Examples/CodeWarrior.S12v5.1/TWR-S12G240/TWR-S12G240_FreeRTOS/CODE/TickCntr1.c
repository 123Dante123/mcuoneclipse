/** ###################################################################
**     THIS COMPONENT MODULE IS GENERATED BY THE TOOL. DO NOT MODIFY IT.
**     Filename  : TickCntr1.c
**     Project   : TWR_S12G240_FreeRTOS
**     Processor : MC9S12G240CLL
**     Component : FreeCntr
**     Version   : Component 01.115, Driver 01.14, CPU db: 3.00.010
**     Compiler  : CodeWarrior HC12 C Compiler
**     Date/Time : 04.09.2018, 14:00
**     Abstract  :
**         This device "FreeCntr" implements a free running counter for
**         time measurement.
**     Settings  :
**         Timer name                  : TIM_Counter (16-bit)
**         Compare name                : TC0
**         Counter shared              : No
**
**         High speed mode
**             Prescaler               : divide-by-1
**             Clock                   : 6250000 Hz
**           Period
**             Xtal ticks              : 10000
**             microseconds            : 10000
**             milliseconds            : 10
**             seconds (real)          : 0.01
**             Hz                      : 100
**           Frequency of counting (Bus clock / prescaler)
**             Hz                      : 6250000
**
**         Initialization:
**              Timer                  : Disabled
**
**         Timer registers
**              Counter                : TCNT      [$0044]
**              Mode                   : TIOS      [$0040]
**              Run                    : TSCR1     [$0046]
**              Prescaler              : TSCR2     [$004D]
**              Compare                : TC0       [$0050]
**
**         Interrupt name              : Vtimch0
**         Priority                    : 1
**         User handling procedure     : TickCntr1_OnInterrupt
**         This event is called when the counter is reinitialized
**     Contents  :
**         Enable          - byte TickCntr1_Enable(void);
**         Disable         - byte TickCntr1_Disable(void);
**         GetCounterValue - byte TickCntr1_GetCounterValue(TickCntr1_TTimerValue *Value);
**         SetCompare      - void TickCntr1_SetCompare(TickCntr1_TTimerValue Value);
**
**     Copyright : 1997 - 2011 Freescale Semiconductor, Inc. All Rights Reserved.
**     
**     http      : www.freescale.com
**     mail      : support@freescale.com
** ###################################################################*/


/* MODULE TickCntr1. */

#include "FRTOS1.h"
#include "TickCntr1.h"

#pragma DATA_SEG TickCntr1_DATA        /* Select data segment "TickCntr1_DATA" */
#pragma CODE_SEG TickCntr1_CODE

static bool EnUser;                    /* Enable/Disable device by user */
/*
** ===================================================================
**     Method      :  TickCntr1_Enable (component FreeCntr)
**
**     Description :
**         This method enables the component, i.e. timer is enabled and
**         the internal clocks are counted. The method usually also
**         reset the counter (if it is supported by HW). 
**         The method is not available if the counter is shared.
**     Parameters  : None
**     Returns     :
**         ---             - Error code, possible codes:
**                           ERR_OK - OK
**                           ERR_SPEED - This device does not work in
**                           the active speed mode
** ===================================================================
*/
byte TickCntr1_Enable(void)
{
  if (!EnUser) {                       /* Is the device disabled by user? */
    EnUser = TRUE;                     /* If yes then set the flag "device enabled" */
    TC0 = TCNT + 0xF424U;              /* Store new value to the compare register */ 
    TIE_C0I = 1U;                      /* Enable interrupt */ 
    TSCR1_TEN = 1U;                    /* Start timer */ 
  }
  return ERR_OK;                       /* OK */
}

/*
** ===================================================================
**     Method      :  TickCntr1_Disable (component FreeCntr)
**
**     Description :
**         This method disables the component, i.e. timer is disabled
**         and the internal clocks are stopped. Last counter value is
**         usually preserved in the counter (if it is supported by HW).
**         The method is not available if the counter is shared.
**     Parameters  : None
**     Returns     :
**         ---             - Error code, possible codes:
**                           ERR_OK - OK
**                           ERR_SPEED - This device does not work in
**                           the active speed mode
** ===================================================================
*/
byte TickCntr1_Disable(void)
{
  EnUser = FALSE;                      /* If yes then set the flag "device disabled" */
  TIE_C0I = 0U;                        /* Disable interrupt */ 
  TFLG1 = 0x01U;                       /* Reset interrupt request flag */ 
  TSCR1_TEN = 0U;                      /* Stop timer */ 
  return ERR_OK;                       /* OK */
}

/*
** ===================================================================
**     Method      :  TickCntr1_GetCounterValue (component FreeCntr)
**
**     Description :
**         This method returns a content of the counter.
**     Parameters  :
**         NAME            - DESCRIPTION
**       * Value           - Pointer to returned value.
**     Returns     :
**         ---             - Error code, possible codes:
**                           ERR_OK - OK
**                           ERR_SPEED - This device does not work in
**                           the active speed mode
** ===================================================================
*/
/*
byte TickCntr1_GetCounterValue(TickCntr1_TTimerValue *Value)

**      This method is implemented as a macro. See header module. **
*/

/*
** ===================================================================
**     Method      :  TickCntr1_SetCompare (component FreeCntr)
**
**     Description :
**         This method sets the appropriate compare/modulo/reload
**         register. The method is available only when compare, modulo
**         or reload register is selected in the <Device> property. 
**         [Note:]This is low level method, value written using this
**         method is discarded when changing active speed-mode.
**     Parameters  :
**         NAME            - DESCRIPTION
**         Value           - This value is stored to compare
**                           register.
**     Returns     : Nothing
** ===================================================================
*/
/*
void TickCntr1_SetCompare(TickCntr1_TTimerValue Value)

**  This method is implemented as a macro. See TickCntr1.h file.  **
*/

/*
** ===================================================================
**     Method      :  TickCntr1_Init (component FreeCntr)
**
**     Description :
**         Initializes the associated peripheral(s) and the component 
**         internal variables. The method is called automatically as a 
**         part of the application initialization code.
**         This method is internal. It is used by Processor Expert only.
** ===================================================================
*/
void TickCntr1_Init(void)
{
  EnUser = FALSE;                      /* Disable device */
  /* TC0: BIT15=1,BIT14=1,BIT13=1,BIT12=1,BIT11=0,BIT10=1,BIT9=0,BIT8=0,BIT7=0,BIT6=0,BIT5=1,BIT4=0,BIT3=0,BIT2=1,BIT1=0,BIT0=0 */
  setReg16(TC0, 0xF424U);              /* Store given value to the compare register */ 
}

/*
** ===================================================================
**     Method      :  TickCntr1_Interrupt (component FreeCntr)
**
**     Description :
**         The method services the interrupt of the selected peripheral(s)
**         and eventually invokes event(s) of the component.
**         This method is internal. It is used by Processor Expert only.
** ===================================================================
*/
#pragma CODE_SEG __NEAR_SEG NON_BANKED
ISR(TickCntr1_Interrupt)
{
  TFLG1 = 0x01U;                       /* Reset interrupt request flag */
  TickCntr1_OnInterrupt();             /* Invoke user event */
}

#pragma CODE_SEG TickCntr1_CODE
/* END TickCntr1. */

/*
** ###################################################################
**
**     This file was created by Processor Expert 3.03 [04.46]
**     for the Freescale HCS12 series of microcontrollers.
**
** ###################################################################
*/
